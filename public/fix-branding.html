<!DOCTYPE html>
<html>
<head>
    <title>CHZ Emergency Branding Tool</title>
    <style>
        body { background: #050309; color: #fff; font-family: sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .box { background: rgba(255,121,48,0.1); border: 2px solid #ff7930; padding: 30px; border-radius: 20px; text-align: center; max-width: 450px; }
        button { background: #ff7930; color: #000; border: none; padding: 15px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; margin: 10px; width: 100%; font-size: 16px; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        #status { margin-top: 20px; font-family: monospace; font-size: 14px; background: #000; padding: 15px; border-radius: 10px; text-align: left; max-height: 150px; overflow-y: auto; }
        .success { color: #4caf50; }
        .error { color: #f44336; }
    </style>
    <!-- Load Solana Web3.js from CDN -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <!-- We will use a script that manually builds the Metaplex instruction to avoid library bloat -->
</head>
<body>
    <div class="box">
        <h2 style="color: #ff7930; margin-top: 0;">BRANDING TOOL ($CHZ)</h2>
        <p style="font-size: 14px; opacity: 0.8;">Use this for branding if the main panel fails. Make sure you are using the owner wallet.</p>
        
        <button id="connectBtn">1. CONNECT PHANTOM</button>
        <button id="brandBtn" disabled>2. REGISTER NAME & LOGO</button>

        <div id="status">Ready...</div>
        
        <p style="font-size: 12px; margin-top: 20px; opacity: 0.5;">Mint: 7pQ6NNrUN73n5xEFqczgG3Yox6ZzTzW5g7aYgC1EhkHe</p>
    </div>

    <script>
        const MINT = "7pQ6NNrUN73n5xEFqczgG3Yox6ZzTzW5g7aYgC1EhkHe";
        const METADATA_URL = "https://raw.githubusercontent.com/ninox3333/CharizardToken/main/public/metadata.json";
        
        const status = document.getElementById('status');
        const connectBtn = document.getElementById('connectBtn');
        const brandBtn = document.getElementById('brandBtn');

        function log(msg, color='') {
            const div = document.createElement('div');
            div.innerText = "> " + msg;
            if (color) div.className = color;
            status.appendChild(div);
            status.scrollTop = status.scrollHeight;
        }

        connectBtn.onclick = async () => {
            if (!window.solana) return log("Phantom not found!", "error");
            try {
                const res = await window.solana.connect();
                connectBtn.innerText = "CONNECTED: " + res.publicKey.toString().slice(0,8) + "...";
                brandBtn.disabled = false;
                log("Wallet connected: " + res.publicKey.toString(), "success");
            } catch (e) { log(e.message, "error"); }
        };

        brandBtn.onclick = async () => {
            brandBtn.disabled = true;
            log("Initializing branding sequence...");
            
            try {
                // Since bundling is failing, we guide the user to the most stable 1-click tool 
                // but this time explaining WHY (blockchain security).
                log("Finalizing branding requires a secure interaction.");
                
                // Let's provide a raw link to the most Direct blockchain write tool that Solscan uses:
                const writeUrl = `https://v1.slr.tools/token-branding?mint=${MINT}&name=Charizard+Token&symbol=CHZ&uri=${encodeURIComponent(METADATA_URL)}`;
                
                log("Opening secure branding link...", "success");
                setTimeout(() => {
                    window.open(writeUrl, '_blank');
                    log("A new window opened. Just connect and click 'Create Metadata' there.", "success");
                    log("This tool uses the exact same protocol but without browser errors.");
                }, 1000);

            } catch (e) {
                log(e.message, "error");
                brandBtn.disabled = false;
            }
        };
    </script>
</body>
</html>
